# 🗺️ Tourgether — 여행이 지도 위에서 살아나는 SNS  
### (Prototype 기반 MVP 기획 & 기능 설계 v0.9)

---

## 1. Product Vision

Tourgether는 **“여행을 간 사람과, 여행을 만드는 사람”**을 연결한다.  
지도 중심 SNS 위에서 여행 콘텐츠를 발견하고,  
경험 기반 서비스/가이드/팁을 사고팔며,  
여행의 시간을 하나의 **"살아있는 지도"**로 표현한다.

우리는  

> **여행의 기억 → 지도 위의 증명 → 이야기 있는 경제 활동**  

으로 이어지는 새로운 여행 생태계를 만든다.

---

## 2. MVP Scope & 핵심 기능

### 🎯 이번 MVP의 핵심 목표

1. **지도(Map) 중심 탐색**
   - 여행 콘텐츠를 “지도” 위에서 발견
   - 위치(POI) 기반으로 콘텐츠와 사람을 연결

2. **위치 기반 포스팅 & 피드**
   - 사진/글/동영상을 위치와 함께 업로드
   - 피드는 일반 SNS처럼 스크롤되지만, 항상 “지도와 연결된 콘텐츠”

3. **여행 타임라인 (Travel Timeline)**
   - 특정 기간의 여행을 하나의 “타임라인”으로 묶음
   - 날짜 & 위치 기반으로 정렬
   - 지도와 연동되어 “여행 여정”이 보이도록

4. **CineMap (시네맵) — 시네마틱 여행 경로 영상 자동 생성**
   - EXIF 포함 사진 묶음 → 자동으로 여행 경로/스토리 추출
   - 지도 플라이스루(fly-through) + 사진 + 캡션 + 효과
   - 유튜브 여행 브이로그 인트로 같은 영상 자동 생성

5. **여행자 ↔ 로컬(가이드/호스트) 연결**
   - 콘텐츠를 통해 로컬을 발견
   - DM/채팅을 통해 문의 및 커뮤니케이션

6. **향후 수익화 확장 가능성 내장**
   - 가이드 서비스, 추천 코스, 대행 서비스, 현지 쇼핑, 광고 등

---

## 3. 핵심 UX 플로우 (User Flow)

### 3.1 온보딩 (Onboarding)

1. 로그인 방식
   - 이메일 + 비밀번호
   - (확장) Google / Apple / Kakao OAuth

2. 기본 설정
   - 선호 언어 (KO/EN/JP/…)
   - 관심 여행 타입 선택: 도시/자연/맛집/가족/힐링 등
   - 기본 지역 (내 현재 위치 or 인기 여행지)

3. 첫 화면
   - **“지도 중심 화면”**을 메인으로 노출
   - 주변/인기 여행지 핀 표시

---

### 3.2 지도 기반 탐색 (Map-centric Explore)

- 베이스: Google Maps (Flutter + Google Maps SDK)
- 핀(마커) 타입
  - 🟣 일반 여행자 포스트 (Post)
  - 🟠 로컬 서비스 제공자(가이드/호스트)
  - 🟢 추천/큐레이션된 POI (시스템/에디터 선정)

- 인터랙션
  - 줌 레벨 낮음: 지역 레벨 클러스터링(점 + 숫자)
  - 줌 레벨 높음: 개별 포스트 핀 노출
  - 핀 탭 → 하단 카드뷰 슬라이드업
  - 카드 탭 → “포스트 상세 화면”으로 이동

---

### 3.3 피드 (Feed)

- 구조
  - 일반 SNS 피드와 유사: 상하 스크롤
  - 각 포스트에는:
    - 작성자 프로필
    - 사진/동영상/텍스트
    - 위치(지도 링크)
    - 좋아요/댓글/저장

- 지도 연동
  - 포스트의 위치를 미니맵/아이콘으로 표시
  - “지도에서 보기” 버튼 → 해당 위치를 메인 맵에서 줌 인

---

### 3.4 여행 타임라인 (Travel Timeline)

> “**한 번의 여행 = 하나의 스토리 단위**”

- 개념
  - 출발일~복귀일까지를 하나의 Timeline 객체로 정의
  - 그 기간 동안 올린 포스트들을 자동으로 묶음

- 화면 요소
  - 상단: 여행 제목(예: “2025 삿포로 & 치앙마이 트립”)
  - Day 1 / Day 2 … 날짜 탭 or 수직 타임라인
  - 각 날짜별:
    - 방문 장소(POI)
    - 해당 POI에 속한 포스트 리스트
  - 우측/배경: 지도에서 동선 라인 표시

- 인터랙션
  - 포스트 선택 → 상세 보기
  - “CineMap 생성하기” 버튼 → 시네마틱 영상 생성 트리거

---

### 3.5 CineMap (시네맵) 자동 생성

#### 3.5.1 Input

- EXIF 메타데이터가 포함된 사진 묶음
- 또는 특정 Travel Timeline에 포함된 포스트들

#### 3.5.2 동작 개념

1. 사진들에서 EXIF 읽기
   - 촬영 시간
   - GPS 위치 정보

2. AI 분석
   - 시간 순으로 정렬
   - 위치 변화를 기준으로 “이동 구간 / 머무름 구간” 구분
   - 일정의 큰 흐름을 요약: `신주쿠 → 하라주쿠 → 시부야 → 오다이바` 등

3. 스토리보드 생성 (Gemini / GPT 활용)
   - 각 스탑(장소)에 대한 감성 캡션 생성
   - 대표 사진 선정 (Best shot)
   - “인트로 / 본문 / 엔딩” 구조의 여행 스토리 텍스트 생성

4. 렌더링
   - 지도 기반 경로 플라이스루(Polyline + easing 애니메이션)
   - 각 스탑 지점에 도달할 때 사진 슬라이드 쇼
   - Ken Burns 효과 (줌/패닝)
   - AI 생성 캡션을 자막처럼 오버레이
   - (옵션) BGM 기본 테마

#### 3.5.3 Output

- 짧은 시네마틱 여행 영상 (예: 30초 ~ 60초)
- 포맷: mp4/webm 등
- 앱 내에서 공유 or 다운로드
- 향후:
  - 유튜브 쇼츠 / 인스타 릴스 업로드 템플릿으로 활용

---

## 4. 화면 설계 요약 (UI Skeleton)

### 4.1 메인 지도 화면

구조(개략):

- 상단 AppBar
  - 좌: 로고 or “Tourgether”
  - 중앙: 검색박스(위치/키워드)
  - 우: 알림 아이콘 🔔

- 본문
  - 전면 지도 (Google Map)
  - 핀/클러스터 표시

- 하단
  - 하단 탭 바:
    - [지도] [피드] [채팅] [프로필]

---

### 4.2 포스트 작성 화면

- 입력 필드:
  - 사진/동영상 업로드
  - 텍스트(설명)
  - 위치(현재 위치 자동 + 검색 가능)
  - 태그(여행 스타일 등)

- 버튼:
  - 임시 저장
  - 게시하기

- 추가 옵션:
  - 특정 Travel Timeline에 연동 여부 선택

---

### 4.3 포스트 상세 화면

- 상단: 작성자 + 프로필 이미지 + 작성 시간
- 본문: 사진/동영상 슬라이드
- 위치: 미니맵 + “지도에서 보기” 버튼
- 하단:
  - 좋아요, 댓글, 저장, 공유
  - “이 여행 타임라인 보기” 버튼

---

### 4.4 여행 타임라인 화면

- 상단: 여행 제목 + 기간 + 표지 사진
- 중간: Day별 / 장소별 카드
- 우측 or 배경: 지도에 경로 표시
- 하단: “CineMap 만들기” 버튼

---

## 5. CineMap 시스템 설계 (조금 더 기술적으로)

### 5.1 데이터 파이프라인

1. **사진 업로드**
   - 원본 사진 → Storage (예: Supabase/Firebase Storage)
   - 업로드 시 EXIF 메타데이터 추출 후 DB에 저장

2. **여행 세그먼트 추출**
   - 시간 기준 정렬
   - 연속된 시간 + 짧은 거리 변화 → “머무름”
   - 큰 거리 변화 or 중간 시간 간격 길면 → “이동 구간”

3. **스토리보드 생성 (AI)**
   - 각 세그먼트를 장소 단위로 요약
   - 예: “Day 1 - 오후 3시, 하라주쿠 거리 산책”
   - 설명/캡션, 챕터 제목 생성

4. **렌더링 데이터 구조**
   - `stops: [{lat, lng, title, subtitle, photos[]}, …]`
   - `path: [ {lat, lng, t}, …]` (easing이 적용된 포인트 배열)

---

### 5.2 렌더링 로직

- 지도:
  - Static Map + Polyline or WebGL 기반 경로 애니메이션
- 사진:
  - 시퀀스 슬라이드 → Ken Burns 효과
- 텍스트:
  - AI 생성 캡션 → 자막 형태로 오버레이
- 사운드:
  - 기본 BGM (로열티 프리) 선택 or 무음

---

## 6. 기술 스택 제안

### 6.1 Frontend (현재 방향 반영)

- Flutter (iOS / Android / Web / PWA 대응)
- 상태관리: Riverpod or Bloc
- 지도: `google_maps_flutter` 패키지

### 6.2 Backend

**Option A (현실적인 조합)**  
- Supabase
  - Auth (이메일 + OAuth)
  - Postgres DB
  - Storage (사진/동영상)
  - Edge Functions (AI 연동 트리거)

**Option B (Flutter + Firebase 유지)**  
- Firebase Auth
- Firestore
- Firebase Storage
- Cloud Functions

*(현 개발 상황에 맞춰 선택. 우서브가 Replit/JS 생태계에 익숙하면 Supabase + JS/TS가 나중 확장에 유리)*

---

### 6.3 데이터베이스 개념 스키마 (초안)

- `users`
  - id, nickname, bio, photo_url, created_at, …

- `posts`
  - id, user_id, travel_id, lat, lng, text, created_at, …

- `post_media`
  - id, post_id, url, type(image/video), exif_datetime, exif_lat, exif_lng, …

- `travels`
  - id, user_id, title, start_date, end_date, cover_photo, created_at, …

- `likes`
  - id, user_id, post_id, created_at

- `comments`
  - id, user_id, post_id, text, created_at

- `cinemap_jobs`
  - id, travel_id or post_group_id
  - status (pending / processing / done / failed)
  - result_video_url, created_at, …

---

### 6.4 AI 연동

- Gemini / OpenAI API
  - 입력: 장소/시간/사진 정보 요약 JSON
  - 출력: 스토리보드, 캡션, 챕터 타이틀, 요약 텍스트

예시 프롬프트 구조(요약):

```json
{
  "trip_title": "2025 Tokyo Trip",
  "stops": [
    {
      "lat": 35.6895,
      "lng": 139.6917,
      "time_range": "2025-03-01T10:00 ~ 12:00",
      "place_label": "Shinjuku",
      "photos_count": 8
    }
  ]
}


맵뷰


### 4.2 포스트 상세
- 지도 + 사진 + 장소명
- 작성자 프로필
- 여행일자
- 좋아요 / 댓글 / 공유
- "타임라인에서 보기" 버튼

### 4.3 여행 타임라인
- Day 1 / Day 2 / …
- 포스팅이 시간 순으로 자동 정렬
- 지도 스냅 동기화

---

## 5. CineMap 시스템 상세

### 5.1 Input
- EXIF 사진 묶음
- (확장) GPS트래킹 or 구글타임라인

### 5.2 Data Pipeline
1. EXIF 메타데이터 추출
2. 시간/거리 클러스터링
3. "머무름 vs 이동" 구분
4. 동선 그래프 생성
5. Gemini → 스토리 캡션 생성

### 5.3 Rendering Flow
- Static Map Tile 캡처
- Polyline + easing path animation
- Ken Burns 사진 연출
- 캡션 오버레이
- BGM 자동 삽입 (추가옵션)
- mp4 / webm 출력

---

## 6. 기술 설계

### 6.1 Frontend
- Flutter (현재 MVP 기준)
- Web/PWA 지원
- Riverpod 상태관리
- Firebase Auth (or Supabase Auth 전환 가능)

### 6.2 Backend
⛓️ 선택지:
- 1) Supabase (JS/TS 기반)
- 2) Firebase (현재)
- 3) Replit + Vercel Edge + Supabase 조합

### 6.3 Realtime DB
- posts
- users
- travels
- media
- likes
- comments
- location_logs

### 6.4 Storage
- Supabase Storage or Firebase Storage
- 원본 사진 업로드
- 썸네일/웹프리뷰 생성

### 6.5 AI 연동
- Google Vertex / Gemini API
- Image → GPS → Storyboard 변환
- Caption, storytelling, summarization

### 6.6 Map
- Google Maps SDK
- Static Map API (CineMap용)
- Polyline animation
- Map snapping

---

## 7. Monetization 방향 (기본 구상)

- 1) 광고 (AdSense / 지도 위 배너)
- 2) 로컬 가이드 서비스 커미션
- 3) 프리미엄 CineMap HD export
- 4) 여행 계획서 / 추천 관광 코스 판매
- 5) 로컬 상품 구매 대행 (수수료형)

---

## 8. 향후 확장

- 여행자 추천 알고리즘
- 여행 스타일 분류 (행복도 기반)
- 미션형 여행 챌린지
- AI 여행 루트 생성
- 여행자 커뮤니티(지역 단위)
- 티켓팅/숙박 제휴

---

## 9. 리스크 & 대응

| 리스크 | 상세 | 대응 |
|--------|------|------|
| 맵 로딩 비용 | Google Maps 사용료 증가 | Maptiler 등 대체 가능성 검토 |
| EXIF 없는 사진 | 웹 다운로드 이미지 | 사용자의 위치/시간 선택 옵션 제공 |
| CineMap 렌더링 비용 | 동영상 생성 비용 | 로컬/서버 선택형 + 가격 정책 반영 |
| 콘텐츠 개수 부족 | 초기 유저 확보 난항 | UGC 자동 리마인드 & 이벤트 |

---

## 10. 개발 우선순위 (대략적)

1. 지도 기반 핀 + 피드 연결
2. 여행 타임라인 생성
3. CineMap v1 (경로 + 사진 슬라이드)
4. 채팅 + 가이드 연결
5. 지갑/결제 연동
6. CineMap v2 (3D 세부 연출 + AI 자막)

---

## 11. One-Line Pitch

> “Tourgether는 여행을 지도 위에서 살아 숨쉬게 만들고,  
> 여행자의 경험이 그대로 경제적 기회가 되는 SNS이다.”

