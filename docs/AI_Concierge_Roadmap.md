# AI 컨시어지 고도화 로드맵

## 문서 정보
- 작성일: 2025-12-09
- 버전: v1.0
- 기반 문서: MVP_설계반영안_v0.1_20250524

---

## 1. 현재 상태 분석 (As-Is)

### 1.1 AI Concierge
- **위치**: `server/ai/concierge.ts`
- **기능**: 채팅 기반 여행 어시스턴트
- **특징**:
  - OpenAI GPT-5.1 모델 사용
  - 사용자 프로필 기반 개인화
  - 주변 Experiences, 최근 Posts 컨텍스트 활용
  - 스트리밍 응답 지원 (SSE)
- **제한점**:
  - 텍스트 응답만 제공 (구조화된 데이터 없음)
  - 외부 API 연동 없음
  - 지도 Pin Point 미지원

### 1.2 Mini Concierge
- **위치**: `server/ai/miniConcierge.ts`
- **기능**: 위치 기반 1시간 액티비티 플랜 생성
- **특징**:
  - 현재 위치(위도/경도) 기반
  - 선호도, 언어 설정 반영
  - 플랜 저장 및 조회 가능
- **제한점**:
  - 1시간 단위 플랜만 지원
  - 외부 정보 수집 없음
  - 피드 작성과 분리됨

---

## 2. 목표 상태 (To-Be)

### 2.1 핵심 목표
사용자가 피드를 작성할 때, AI가 자동으로 관련 정보를 수집하고 추천하여 빠르게 여행 계획을 세울 수 있도록 지원

### 2.2 주요 기능
| 기능 | 설명 |
|------|------|
| 키워드 자동 추출 | 입력 텍스트에서 위치, 기간, 목적 등 추출 |
| 외부 정보 수집 | YouTube, 구글맵, SNS에서 관련 정보 자동 수집 |
| 구조화된 추천 | 경로, 맛집, 장소를 JSON 형태로 제공 |
| 지도 연동 | 추천 장소를 Pin Point로 표시 |
| 피드 통합 | 선택한 정보를 피드에 즉시 추가 |

---

## 3. 구현 옵션

### 3.1 Option A: 기존 컨시어지 고도화 (단계적)

기존 AI Concierge와 Mini Concierge를 점진적으로 개선하는 방식

#### Phase 1: 구조화된 응답 (예상 2주)

**목표**: AI 응답을 구조화된 JSON으로 변경

**현재 응답**:
```
"파리에서는 에펠탑, 루브르 박물관을 추천드려요. 
맛집으로는 앙젤리나 카페가 유명합니다."
```

**목표 응답**:
```json
{
  "summary": "파리 2박3일 추천 일정입니다.",
  "routes": [
    {
      "day": 1,
      "stops": ["루브르 박물관", "튈르리 정원", "콩코드 광장", "샹젤리제"]
    },
    {
      "day": 2,
      "stops": ["노트르담 대성당", "생루이 섬", "마레 지구", "바스티유"]
    }
  ],
  "places": [
    {
      "name": "에펠탑",
      "category": "landmark",
      "location": {"lat": 48.8584, "lng": 2.2945},
      "rating": 4.7,
      "description": "파리의 상징"
    }
  ],
  "restaurants": [
    {
      "name": "앙젤리나",
      "category": "cafe",
      "location": {"lat": 48.8651, "lng": 2.3284},
      "rating": 4.5,
      "specialty": "핫초콜릿, 몽블랑"
    }
  ]
}
```

**구현 항목**:
- [ ] 프롬프트 수정: JSON 출력 형식 지정
- [ ] 응답 파서 구현: AI 응답 → 구조화된 객체
- [ ] 타입 정의: `ConciergeRecommendation` 인터페이스
- [ ] 프론트엔드: 구조화된 데이터 렌더링 컴포넌트

**예상 작업량**: 2주

---

#### Phase 2: 외부 API 연동 (예상 3주)

**목표**: 외부 서비스에서 실시간 정보 수집

| API | 용도 | 구현 방식 | 우선순위 |
|-----|------|----------|---------|
| Google Places API | 장소 정보, 별점, 리뷰 | 이미 연동됨, 확장 필요 | 높음 |
| YouTube Data API | 여행 Vlog, 맛집 영상 | 키워드 검색 → 조회수 정렬 | 높음 |
| Instagram Basic API | 해시태그 인기 포스팅 | OAuth 필요, 제한적 | 낮음 |

**구현 항목**:

**2-1. Google Places 확장**
- [ ] 장소 상세 정보 조회 (리뷰, 영업시간)
- [ ] 주변 맛집/카페 자동 검색
- [ ] 별점/리뷰 수 기반 정렬

**2-2. YouTube Data API 연동**
- [ ] API 키 설정 및 환경변수 추가
- [ ] 키워드 기반 영상 검색
- [ ] 조회수/좋아요 기준 상위 5개 추출
- [ ] 썸네일, 링크 정보 반환

**2-3. 정보 통합 레이어**
- [ ] 외부 데이터 캐싱 (Redis/메모리)
- [ ] AI 프롬프트에 외부 데이터 주입
- [ ] 출처별 분류 및 표시

**예상 작업량**: 3주

---

#### Phase 3: 피드 작성 통합 (예상 2주)

**목표**: 피드 작성 화면에서 AI 추천을 즉시 활용

**구현 항목**:
- [ ] 피드 작성 화면에 "AI 추천" 버튼 추가
- [ ] 입력 텍스트 실시간 분석 (debounce)
- [ ] 키워드 자동 추출 프롬프트
- [ ] 추천 결과 패널 UI
- [ ] "추가" 버튼 → 피드 내용에 삽입
- [ ] 선택한 장소 → 위치 정보 자동 입력

**UI 흐름**:
```
[피드 작성 화면]
┌─────────────────────────────────┐
│ "이번 여름 파리 여행 계획..."     │
│                                 │
│ [📷 사진] [🤖 AI 추천]           │
└─────────────────────────────────┘
         ↓ AI 추천 클릭
┌─────────────────────────────────┐
│ AI 추천 결과                     │
│                                 │
│ 🗺️ 추천 경로                     │
│   루브르 → 노트르담 → 에펠탑 [+]  │
│                                 │
│ 🍽️ 추천 맛집                     │
│   앙젤리나 카페 ⭐4.5 [+]         │
│   라뒤레 ⭐4.3 [+]               │
│                                 │
│ 📺 YouTube 리뷰                  │
│   "파리 3일 Vlog" 조회수 50만 [+] │
│                                 │
│ 📍 구글맵 정보                    │
│   [지도에서 보기]                 │
└─────────────────────────────────┘
```

**예상 작업량**: 2주

---

### 3.2 Option B: 새로운 Travel Planner 기능

별도의 "여행 플래너" 기능으로 구현하는 방식

#### 개요
기존 컨시어지와 역할을 분리하여, 피드 작성 전 단계에서 여행 계획을 수립하는 전용 기능

#### 구조
```
[홈] → [+ 새 여행 계획] → [Travel Planner 화면]
                              ↓
                    ┌─────────────────────┐
                    │ 여행 계획 작성하기     │
                    │                     │
                    │ "2박3일 파리 여행"    │
                    │                     │
                    │ [AI 분석 시작]       │
                    └─────────────────────┘
                              ↓
                    ┌─────────────────────┐
                    │ AI 키워드 추출        │
                    │ • 위치: 파리          │
                    │ • 기간: 2박3일        │
                    │ • 목적: 자유여행      │
                    └─────────────────────┘
                              ↓
                    ┌─────────────────────┐
                    │ 정보 수집 중...       │
                    │ ☑️ 구글맵 장소        │
                    │ ☑️ YouTube 영상      │
                    │ ☐ 인스타그램         │
                    └─────────────────────┘
                              ↓
                    ┌─────────────────────┐
                    │ 추천 결과            │
                    │                     │
                    │ [추천 경로] [맛집]    │
                    │ [YouTube] [SNS]     │
                    │                     │
                    │ [피드로 저장]         │
                    └─────────────────────┘
```

#### 구현 항목
- [ ] Travel Planner 페이지 생성 (`/travel-planner`)
- [ ] 키워드 추출 API 엔드포인트
- [ ] 외부 정보 수집 서비스
- [ ] 추천 결과 렌더링 컴포넌트
- [ ] 피드 변환 및 저장 로직
- [ ] 저장된 플랜 목록 관리

#### 장점
- 기존 기능과 역할 분리 명확
- UX 복잡도 관리 용이
- 독립적인 테스트 가능

#### 단점
- 새로운 화면 개발 필요
- 기존 컨시어지와 중복 가능성
- 사용자 진입점 추가 필요

**예상 작업량**: 4~5주

---

### 3.3 Option C: 혼합 방식 (권장)

A안 Phase 1을 먼저 진행하고, 사용자 피드백 후 B안 검토

#### 진행 순서

**Stage 1 (2주)**: A안 Phase 1
- 구조화된 응답 구현
- 기존 AI Concierge에 적용
- 지도 Pin Point 표시

**Stage 2 (평가)**: 사용자 피드백 수집
- 구조화된 추천의 활용도 측정
- 피드 작성 시 AI 필요성 확인
- 외부 정보 수요 파악

**Stage 3 (분기)**:
- 피드백 긍정적 → A안 Phase 2, 3 진행
- 별도 플래너 필요 → B안 진행
- 둘 다 필요 → 병렬 진행

---

## 4. 기술 스택

### 4.1 백엔드
| 항목 | 기술 |
|------|------|
| AI 모델 | OpenAI GPT-5.1 |
| 외부 API | Google Places API, YouTube Data API |
| 캐싱 | 메모리 캐시 (memoizee) |
| 프롬프트 관리 | 템플릿 기반 동적 생성 |

### 4.2 프론트엔드
| 항목 | 기술 |
|------|------|
| 지도 | Google Maps JavaScript API |
| 상태 관리 | TanStack Query |
| UI 컴포넌트 | Radix UI + shadcn/ui |
| 스트리밍 | Server-Sent Events (SSE) |

### 4.3 새로 필요한 환경변수
```
YOUTUBE_DATA_API_KEY=...
INSTAGRAM_ACCESS_TOKEN=...  # 선택적
```

---

## 5. 우선순위 및 일정

### 5.1 권장 우선순위

| 순위 | 항목 | 이유 |
|------|------|------|
| 1 | 구조화된 응답 | 기존 인프라 활용, 즉시 효과 |
| 2 | 지도 Pin Point | 시각적 개선, 사용성 향상 |
| 3 | 피드 추가 버튼 | 핵심 UX 개선 |
| 4 | YouTube API 연동 | 높은 사용자 가치 |
| 5 | 인스타그램 연동 | API 제한으로 후순위 |

### 5.2 예상 일정 (혼합 방식 기준)

```
Week 1-2:  Phase 1 - 구조화된 응답
Week 3:    평가 및 피드백 수집
Week 4-6:  Phase 2 - 외부 API 연동
Week 7-8:  Phase 3 - 피드 통합
Week 9:    테스트 및 안정화
```

---

## 6. 리스크 및 대응

| 리스크 | 영향 | 대응 방안 |
|--------|------|----------|
| YouTube API 할당량 초과 | 서비스 중단 | 캐싱 적극 활용, 할당량 모니터링 |
| 인스타그램 API 제한 | 기능 축소 | 대안 플랫폼 검토 (Pinterest 등) |
| AI 응답 형식 불일치 | 파싱 오류 | Fallback 로직, 형식 검증 |
| 외부 API 비용 증가 | 운영 비용 상승 | 사용량 제한, Trip Pass 연동 |

---

## 7. 성공 지표

| 지표 | 목표 |
|------|------|
| AI 추천 사용률 | 피드 작성의 30% 이상 |
| 추천 항목 추가율 | 제시된 추천의 20% 이상 |
| 피드 작성 시간 단축 | 평균 30% 감소 |
| 사용자 만족도 | NPS 40 이상 |

---

## 8. 다음 단계

1. Option 선택 (A / B / C)
2. Phase 1 세부 설계
3. 프롬프트 엔지니어링
4. 프로토타입 개발
5. 내부 테스트
6. 점진적 배포
